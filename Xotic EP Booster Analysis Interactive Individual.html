<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RhPf Electronics Xotic EP Booster Analysis Interactive Individual</title>
    <meta name="description" content="Interactive analysis tool for the Xotic EP Booster.">
    <meta name="author" content="RhPf Electronics">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        if (!window.Plotly) {
            document.write('<script src="/path-to-local-plotly/plotly-latest.min.js"><\/script>');
        }
    </script>
    <style>
        body {
            display: flex;
            flex-direction: row; /* Stack pedal and graph horizontally */
            justify-content: left;
            align-items: top;
            margin: 0;
            height: auto;
        }

        #pedal-container {
            width: 100%; /* Scale pedal container to fit the viewport */
            height: 100vh; /* Maintain aspect ratio */
            margin: 0;
        }

        #pedal-svg {
            width: 100%; /* Make the SVG scale with the container */
            height: 100vh; /* Maintain aspect ratio */
            margin: 0;
        }

        #graph {
            width: 100%; /* Take up most of the width */
            height: 100vh; /* Dynamically scale height relative to the viewport */
            margin: 0; /* Add some spacing between graph and pedal */
        }

    </style>
</head>
<body>
    <!-- Pedal with Knobs -->
    <div id="pedal-container">
        <svg id="pedal-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1884 3600">
            <!-- Background Image -->
            <image href="https://thomasbe86.github.io/plotly-plot/Xotic%20EP%20Booster.png" x="0" y="0" width="1884" height="3600" />
<g id="knob-Level" transform="translate(1010, 940)">
    <circle cx="0" cy="0" r="390" fill="#FFFFFF" stroke="none" stroke-width="3" />
    <line id="Level-pointer" x1="0" y1="0" x2="0" y2="-370" stroke="#000" stroke-width="15" stroke-linecap="round" />
</g>
        </svg>
    </div>

    <!-- Graph -->
    <div id="graph"></div>

    <script>
        // Ensure Plotly resizes with window changes
        window.addEventListener('resize', () => {
            Plotly.Plots.resize(document.getElementById('graph'));
        });
    </script>

    <script>
        // Frequency Data
        const frequency = [
            20, 21.44, 22.97, 24.62, 26.39, 28.28, 30.31, 32.49, 34.82, 37.32, 40,
            42.87, 45.95, 49.25, 52.78, 56.57, 60.63, 64.98, 69.64, 74.64, 80,
            85.74, 91.89, 98.49, 105.56, 113.13, 121.25, 129.96, 139.28, 149.29, 160,
            171.48, 183.79, 196.98, 211.12, 226.27, 242.51, 259.92, 278.58, 298.57,
            320, 342.97, 367.58, 393.97, 422.24, 452.55, 485.03, 519.84, 557.15,
            597.14, 640, 685.93, 735.17, 787.93, 844.49, 905.1, 970.06, 1039.68,
            1114.3, 1194.28, 1280, 1371.87, 1470.33, 1575.86, 1688.97, 1810.19,
            1940.12, 2079.37, 2228.61, 2388.56, 2560, 2743.74, 2940.67, 3151.73,
            3377.94, 3620.39, 3880.23, 4158.73, 4457.22, 4777.13, 5120, 5487.48,
            5881.34, 6303.46, 6755.88, 7240.77, 7760.47, 8317.46, 8914.44, 9554.26,
            10240, 10974.96, 11762.67, 12606.92, 13511.76, 14481.55, 15520.94,
            16634.93, 17828.88, 19108.52
        ];

        const LevelPositions = {
            0: [3.32, 3.3262, 3.3316, 3.3363, 3.3404, 3.3439, 3.3471, 3.3497, 3.3521, 3.3541, 3.3559, 3.3574, 3.3586, 3.3597, 3.3606, 3.3614, 3.362, 3.3625, 3.3629, 3.3631, 3.3633, 3.3633, 3.3632, 3.363, 3.3627, 3.3623, 3.3618, 3.3611, 3.3603, 3.3593, 3.3582, 3.3568, 3.3552, 3.3534, 3.3513, 3.3488, 3.3459, 3.3427, 3.3389, 3.3346, 3.3297, 3.324, 3.3175, 3.3102, 3.3017, 3.2921, 3.2812, 3.2687, 3.2546, 3.2386, 3.2206, 3.2002, 3.1772, 3.1514, 3.1225, 3.0903, 3.0546, 3.015, 2.9713, 2.9234, 2.8712, 2.8145, 2.7534, 2.6878, 2.618, 2.5442, 2.4666, 2.3857, 2.3019, 2.2158, 2.1278, 2.0387, 1.9489, 1.8591, 1.7698, 1.6816, 1.5949, 1.5102, 1.4278, 1.3479, 1.2709, 1.1968, 1.1259, 1.0582, 0.9937, 0.9324, 0.8743, 0.8194, 0.7674, 0.7184, 0.6723, 0.6289, 0.5881, 0.5498, 0.5139, 0.4802, 0.4486, 0.419, 0.3914, 0.3655],
            5: [3.3854, 3.3918, 3.3974, 3.4022, 3.4065, 3.4102, 3.4134, 3.4162, 3.4187, 3.4208, 3.4226, 3.4241, 3.4255, 3.4266, 3.4276, 3.4283, 3.429, 3.4295, 3.4299, 3.4301, 3.4303, 3.4303, 3.4303, 3.4301, 3.4298, 3.4294, 3.4288, 3.4282, 3.4273, 3.4263, 3.4252, 3.4238, 3.4222, 3.4203, 3.4181, 3.4156, 3.4127, 3.4093, 3.4055, 3.4011, 3.3961, 3.3903, 3.3837, 3.3762, 3.3676, 3.3578, 3.3466, 3.3339, 3.3196, 3.3032, 3.2848, 3.264, 3.2406, 3.2143, 3.1848, 3.152, 3.1155, 3.0751, 3.0306, 2.9818, 2.9285, 2.8707, 2.8083, 2.7414, 2.6702, 2.5949, 2.5158, 2.4333, 2.3478, 2.26, 2.1703, 2.0793, 1.9878, 1.8962, 1.8051, 1.7152, 1.6268, 1.5403, 1.4562, 1.3748, 1.2962, 1.2207, 1.1484, 1.0793, 1.0135, 0.951, 0.8918, 0.8357, 0.7827, 0.7328, 0.6857, 0.6414, 0.5998, 0.5608, 0.5241, 0.4898, 0.4575, 0.4274, 0.3992, 0.3727],
            10: [3.4316, 3.4382, 3.4439, 3.449, 3.4533, 3.4571, 3.4605, 3.4633, 3.4658, 3.468, 3.4699, 3.4715, 3.4728, 3.474, 3.475, 3.4758, 3.4765, 3.477, 3.4774, 3.4776, 3.4778, 3.4779, 3.4778, 3.4776, 3.4773, 3.4769, 3.4764, 3.4757, 3.4748, 3.4738, 3.4726, 3.4712, 3.4696, 3.4677, 3.4655, 3.4629, 3.46, 3.4566, 3.4527, 3.4483, 3.4432, 3.4373, 3.4306, 3.423, 3.4143, 3.4043, 3.393, 3.3802, 3.3656, 3.349, 3.3303, 3.3092, 3.2855, 3.2588, 3.229, 3.1957, 3.1587, 3.1177, 3.0726, 3.0231, 2.9691, 2.9105, 2.8472, 2.7795, 2.7073, 2.6309, 2.5507, 2.467, 2.3804, 2.2913, 2.2003, 2.1081, 2.0153, 1.9225, 1.8302, 1.7389, 1.6493, 1.5617, 1.4764, 1.3939, 1.3142, 1.2376, 1.1643, 1.0943, 1.0276, 0.9642, 0.9041, 0.8473, 0.7936, 0.7429, 0.6952, 0.6503, 0.6082, 0.5685, 0.5314, 0.4965, 0.4639, 0.4333, 0.4047, 0.3779],
            15: [3.4938, 3.5006, 3.5065, 3.5118, 3.5163, 3.5203, 3.5237, 3.5267, 3.5293, 3.5315, 3.5335, 3.5351, 3.5365, 3.5378, 3.5388, 3.5396, 3.5403, 3.5409, 3.5413, 3.5416, 3.5417, 3.5418, 3.5417, 3.5416, 3.5413, 3.5409, 3.5403, 3.5396, 3.5388, 3.5377, 3.5365, 3.5351, 3.5334, 3.5315, 3.5292, 3.5266, 3.5237, 3.5202, 3.5163, 3.5117, 3.5065, 3.5006, 3.4938, 3.486, 3.4771, 3.467, 3.4555, 3.4424, 3.4275, 3.4107, 3.3916, 3.3701, 3.3459, 3.3188, 3.2884, 3.2545, 3.2168, 3.1751, 3.1291, 3.0787, 3.0237, 2.964, 2.8996, 2.8306, 2.7571, 2.6793, 2.5976, 2.5124, 2.4242, 2.3334, 2.2408, 2.1469, 2.0524, 1.9578, 1.8638, 1.7709, 1.6796, 1.5904, 1.5036, 1.4195, 1.3384, 1.2604, 1.1857, 1.1144, 1.0465, 0.9819, 0.9208, 0.8629, 0.8082, 0.7566, 0.708, 0.6623, 0.6193, 0.579, 0.5412, 0.5057, 0.4724, 0.4413, 0.4121, 0.3849],
            20: [3.5957, 3.6029, 3.6093, 3.6148, 3.6197, 3.6239, 3.6276, 3.6308, 3.6335, 3.6359, 3.638, 3.6398, 3.6413, 3.6426, 3.6437, 3.6446, 3.6453, 3.6459, 3.6464, 3.6467, 3.6469, 3.647, 3.6469, 3.6467, 3.6464, 3.646, 3.6455, 3.6448, 3.6439, 3.6428, 3.6416, 3.6401, 3.6384, 3.6364, 3.6341, 3.6315, 3.6284, 3.6248, 3.6208, 3.6161, 3.6107, 3.6046, 3.5976, 3.5896, 3.5804, 3.57, 3.5582, 3.5447, 3.5294, 3.512, 3.4924, 3.4703, 3.4454, 3.4174, 3.3861, 3.3512, 3.3124, 3.2695, 3.2221, 3.1702, 3.1136, 3.0521, 2.9858, 2.9147, 2.839, 2.7589, 2.6748, 2.5871, 2.4962, 2.4028, 2.3074, 2.2107, 2.1134, 2.016, 1.9192, 1.8236, 1.7296, 1.6377, 1.5483, 1.4617, 1.3781, 1.2979, 1.221, 1.1475, 1.0776, 1.0111, 0.9481, 0.8885, 0.8322, 0.7791, 0.729, 0.682, 0.6377, 0.5962, 0.5572, 0.5207, 0.4865, 0.4544, 0.4244, 0.3963],
            25: [3.7403, 3.7483, 3.7553, 3.7614, 3.7667, 3.7713, 3.7754, 3.7789, 3.7819, 3.7846, 3.7868, 3.7888, 3.7905, 3.7919, 3.7931, 3.7941, 3.795, 3.7956, 3.7961, 3.7965, 3.7967, 3.7968, 3.7968, 3.7967, 3.7964, 3.796, 3.7954, 3.7947, 3.7938, 3.7927, 3.7914, 3.7899, 3.7881, 3.786, 3.7836, 3.7809, 3.7777, 3.774, 3.7697, 3.7649, 3.7593, 3.7529, 3.7456, 3.7373, 3.7278, 3.7169, 3.7046, 3.6905, 3.6746, 3.6566, 3.6361, 3.6131, 3.5872, 3.5581, 3.5255, 3.4891, 3.4487, 3.404, 3.3547, 3.3007, 3.2417, 3.1777, 3.1087, 3.0347, 2.9558, 2.8725, 2.7849, 2.6935, 2.5989, 2.5016, 2.4024, 2.3017, 2.2003, 2.099, 1.9982, 1.8986, 1.8007, 1.705, 1.612, 1.5218, 1.4348, 1.3513, 1.2712, 1.1947, 1.1219, 1.0527, 0.9871, 0.9251, 0.8664, 0.8111, 0.759, 0.71, 0.664, 0.6207, 0.5802, 0.5421, 0.5065, 0.4731, 0.4418, 0.4126],
            30: [4.0028, 4.0124, 4.0208, 4.0282, 4.0346, 4.0402, 4.045, 4.0493, 4.053, 4.0561, 4.0589, 4.0613, 4.0633, 4.0651, 4.0665, 4.0678, 4.0688, 4.0696, 4.0703, 4.0708, 4.0711, 4.0713, 4.0713, 4.0712, 4.071, 4.0705, 4.07, 4.0692, 4.0683, 4.0671, 4.0658, 4.0642, 4.0623, 4.0601, 4.0575, 4.0545, 4.0511, 4.0472, 4.0426, 4.0374, 4.0315, 4.0246, 4.0168, 4.0079, 3.9977, 3.986, 3.9728, 3.9577, 3.9407, 3.9213, 3.8994, 3.8747, 3.8469, 3.8157, 3.7807, 3.7417, 3.6984, 3.6505, 3.5976, 3.5396, 3.4764, 3.4078, 3.3337, 3.2544, 3.1698, 3.0804, 2.9865, 2.8885, 2.7871, 2.6827, 2.5763, 2.4683, 2.3596, 2.2509, 2.1428, 2.036, 1.9311, 1.8285, 1.7286, 1.632, 1.5387, 1.4491, 1.3632, 1.2812, 1.2031, 1.1289, 1.0586, 0.992, 0.9291, 0.8698, 0.814, 0.7614, 0.712, 0.6657, 0.6221, 0.5813, 0.5431, 0.5073, 0.4738, 0.4425],
            35: [4.3116, 4.3237, 4.3343, 4.3435, 4.3516, 4.3587, 4.3648, 4.3702, 4.3748, 4.3788, 4.3823, 4.3854, 4.388, 4.3902, 4.3921, 4.3937, 4.395, 4.3961, 4.397, 4.3977, 4.3982, 4.3985, 4.3986, 4.3986, 4.3984, 4.398, 4.3974, 4.3967, 4.3957, 4.3945, 4.3931, 4.3914, 4.3894, 4.387, 4.3842, 4.3811, 4.3774, 4.3731, 4.3682, 4.3626, 4.3562, 4.3488, 4.3403, 4.3307, 4.3197, 4.3071, 4.2928, 4.2765, 4.2581, 4.2372, 4.2135, 4.1868, 4.1568, 4.123, 4.0853, 4.0431, 3.9963, 3.9445, 3.8874, 3.8248, 3.7564, 3.6822, 3.6022, 3.5165, 3.4251, 3.3285, 3.227, 3.1212, 3.0115, 2.8988, 2.7838, 2.6671, 2.5497, 2.4322, 2.3154, 2.2, 2.0866, 1.9757, 1.8679, 1.7634, 1.6626, 1.5658, 1.473, 1.3844, 1.3, 1.2198, 1.1438, 1.0719, 1.004, 0.9399, 0.8795, 0.8227, 0.7694, 0.7193, 0.6722, 0.6282, 0.5868, 0.5482, 0.512, 0.4781],
            40: [4.6884, 4.7045, 4.7186, 4.7309, 4.7417, 4.7512, 4.7594, 4.7666, 4.7728, 4.7783, 4.783, 4.7871, 4.7906, 4.7936, 4.7962, 4.7984, 4.8003, 4.8019, 4.8031, 4.8041, 4.8049, 4.8054, 4.8058, 4.8059, 4.8058, 4.8055, 4.805, 4.8042, 4.8033, 4.802, 4.8005, 4.7987, 4.7965, 4.794, 4.791, 4.7875, 4.7835, 4.7789, 4.7736, 4.7675, 4.7604, 4.7524, 4.7432, 4.7326, 4.7206, 4.7069, 4.6912, 4.6735, 4.6533, 4.6304, 4.6046, 4.5754, 4.5426, 4.5057, 4.4645, 4.4184, 4.3673, 4.3106, 4.2482, 4.1798, 4.1051, 4.024, 3.9366, 3.8429, 3.743, 3.6375, 3.5265, 3.4108, 3.291, 3.1679, 3.0421, 2.9146, 2.7863, 2.6579, 2.5303, 2.4042, 2.2802, 2.1591, 2.0412, 1.927, 1.8169, 1.7111, 1.6097, 1.5128, 1.4206, 1.333, 1.25, 1.1714, 1.0971, 1.0271, 0.9611, 0.8991, 0.8408, 0.786, 0.7346, 0.6864, 0.6413, 0.599, 0.5594, 0.5224],
            45: [5.1455, 5.1682, 5.1881, 5.2056, 5.221, 5.2344, 5.2462, 5.2564, 5.2654, 5.2732, 5.28, 5.2859, 5.291, 5.2954, 5.2992, 5.3024, 5.3052, 5.3075, 5.3094, 5.311, 5.3122, 5.3132, 5.3139, 5.3143, 5.3144, 5.3143, 5.3139, 5.3132, 5.3123, 5.311, 5.3094, 5.3075, 5.3052, 5.3025, 5.2992, 5.2955, 5.2911, 5.286, 5.2801, 5.2734, 5.2656, 5.2568, 5.2466, 5.2349, 5.2216, 5.2065, 5.1892, 5.1695, 5.1472, 5.122, 5.0934, 5.0611, 5.0248, 4.984, 4.9383, 4.8874, 4.8308, 4.7682, 4.6992, 4.6234, 4.5408, 4.4511, 4.3544, 4.2508, 4.1403, 4.0235, 3.9008, 3.7729, 3.6403, 3.5041, 3.365, 3.224, 3.082, 2.94, 2.7988, 2.6593, 2.5222, 2.3882, 2.2578, 2.1315, 2.0097, 1.8926, 1.7805, 1.6734, 1.5714, 1.4745, 1.3826, 1.2957, 1.2135, 1.1361, 1.0631, 0.9945, 0.93, 0.8694, 0.8125, 0.7593, 0.7093, 0.6626, 0.6188, 0.5778],
            50: [5.6336, 5.6659, 5.6943, 5.7193, 5.7414, 5.7607, 5.7777, 5.7925, 5.8055, 5.8169, 5.8268, 5.8354, 5.8428, 5.8493, 5.8549, 5.8597, 5.8639, 5.8674, 5.8703, 5.8728, 5.8748, 5.8764, 5.8776, 5.8785, 5.879, 5.8791, 5.879, 5.8785, 5.8776, 5.8764, 5.8749, 5.8729, 5.8704, 5.8675, 5.864, 5.8599, 5.8551, 5.8496, 5.8431, 5.8357, 5.8272, 5.8174, 5.8061, 5.7933, 5.7786, 5.7618, 5.7427, 5.721, 5.6963, 5.6683, 5.6367, 5.601, 5.5608, 5.5157, 5.4652, 5.4088, 5.3462, 5.2768, 5.2004, 5.1166, 5.0252, 4.926, 4.8189, 4.7042, 4.582, 4.4527, 4.3169, 4.1753, 4.0286, 3.8778, 3.7239, 3.5678, 3.4107, 3.2536, 3.0973, 2.9429, 2.7912, 2.6429, 2.4986, 2.3589, 2.2241, 2.0945, 1.9704, 1.8518, 1.739, 1.6317, 1.53, 1.4338, 1.3429, 1.2572, 1.1765, 1.1005, 1.0291, 0.9621, 0.8992, 0.8402, 0.7849, 0.7332, 0.6848, 0.6394],
            55: [6.2097, 6.2571, 6.2992, 6.3365, 6.3694, 6.3984, 6.424, 6.4464, 6.4661, 6.4834, 6.4985, 6.5116, 6.5231, 6.5331, 6.5418, 6.5493, 6.5557, 6.5612, 6.566, 6.5699, 6.5733, 6.576, 6.5782, 6.5798, 6.581, 6.5817, 6.582, 6.5819, 6.5813, 6.5803, 6.5788, 6.5768, 6.5742, 6.5711, 6.5674, 6.5629, 6.5577, 6.5516, 6.5445, 6.5362, 6.5267, 6.5158, 6.5033, 6.4889, 6.4725, 6.4537, 6.4324, 6.408, 6.3804, 6.3491, 6.3137, 6.2737, 6.2287, 6.1782, 6.1216, 6.0585, 5.9883, 5.9107, 5.8251, 5.7312, 5.6288, 5.5176, 5.3977, 5.2692, 5.1323, 4.9875, 4.8354, 4.6768, 4.5125, 4.3435, 4.1711, 3.9963, 3.8203, 3.6443, 3.4693, 3.2963, 3.1264, 2.9603, 2.7987, 2.6421, 2.4911, 2.346, 2.207, 2.0742, 1.9478, 1.8276, 1.7137, 1.606, 1.5042, 1.4082, 1.3177, 1.2326, 1.1527, 1.0776, 1.0071, 0.9411, 0.8792, 0.8212, 0.7669, 0.7162],
            60: [6.787, 6.8547, 6.9153, 6.9692, 7.0172, 7.0596, 7.0972, 7.1304, 7.1596, 7.1852, 7.2077, 7.2274, 7.2447, 7.2597, 7.2728, 7.2842, 7.294, 7.3025, 7.3098, 7.316, 7.3213, 7.3257, 7.3293, 7.3322, 7.3344, 7.336, 7.337, 7.3375, 7.3373, 7.3366, 7.3354, 7.3335, 7.331, 7.3278, 7.3238, 7.319, 7.3134, 7.3067, 7.2989, 7.2898, 7.2793, 7.2672, 7.2533, 7.2374, 7.2191, 7.1982, 7.1744, 7.1473, 7.1166, 7.0817, 7.0422, 6.9976, 6.9474, 6.891, 6.828, 6.7576, 6.6793, 6.5927, 6.4972, 6.3925, 6.2783, 6.1543, 6.0206, 5.8772, 5.7245, 5.563, 5.3933, 5.2163, 5.0331, 4.8447, 4.6523, 4.4574, 4.2611, 4.0647, 3.8695, 3.6766, 3.4871, 3.3018, 3.1215, 2.9469, 2.7785, 2.6166, 2.4615, 2.3135, 2.1724, 2.0384, 1.9114, 1.7912, 1.6776, 1.5706, 1.4697, 1.3748, 1.2856, 1.2018, 1.1232, 1.0496, 0.9805, 0.9159, 0.8553, 0.7987],
            65: [7.3589, 7.4527, 7.5372, 7.6131, 7.681, 7.7415, 7.7953, 7.843, 7.8853, 7.9225, 7.9553, 7.9842, 8.0095, 8.0316, 8.051, 8.0678, 8.0825, 8.0952, 8.1062, 8.1156, 8.1236, 8.1305, 8.1362, 8.1408, 8.1446, 8.1475, 8.1496, 8.151, 8.1516, 8.1515, 8.1506, 8.149, 8.1466, 8.1434, 8.1394, 8.1344, 8.1283, 8.1211, 8.1126, 8.1027, 8.0912, 8.0778, 8.0625, 8.0448, 8.0246, 8.0015, 7.9751, 7.945, 7.9109, 7.8721, 7.8282, 7.7787, 7.7229, 7.6603, 7.5902, 7.5119, 7.425, 7.3287, 7.2225, 7.1061, 6.9791, 6.8413, 6.6926, 6.5333, 6.3635, 6.184, 5.9953, 5.7986, 5.5949, 5.3854, 5.1716, 4.9549, 4.7366, 4.5183, 4.3014, 4.0869, 3.8762, 3.6702, 3.4699, 3.2758, 3.0885, 2.9086, 2.7362, 2.5716, 2.4148, 2.2659, 2.1247, 1.991, 1.8648, 1.7458, 1.6337, 1.5282, 1.429, 1.3359, 1.2485, 1.1666, 1.0899, 1.018, 0.9507, 0.8877],
            70: [7.9074, 8.0326, 8.1465, 8.2496, 8.3426, 8.4261, 8.5008, 8.5674, 8.6267, 8.6792, 8.7257, 8.7667, 8.8028, 8.8345, 8.8623, 8.8866, 8.9078, 8.9263, 8.9423, 8.9561, 8.968, 8.9782, 8.9868, 8.994, 8.9999, 9.0046, 9.0083, 9.011, 9.0126, 9.0134, 9.0132, 9.0121, 9.0101, 9.0071, 9.003, 8.9979, 8.9915, 8.9838, 8.9747, 8.964, 8.9514, 8.9368, 8.92, 8.9006, 8.8783, 8.8528, 8.8237, 8.7905, 8.7528, 8.7099, 8.6614, 8.6067, 8.545, 8.4757, 8.3981, 8.3116, 8.2153, 8.1088, 7.9914, 7.8626, 7.7221, 7.5696, 7.4051, 7.2287, 7.0409, 6.8422, 6.6335, 6.4158, 6.1904, 5.9586, 5.7221, 5.4822, 5.2408, 4.9992, 4.7591, 4.5219, 4.2887, 4.0608, 3.8391, 3.6243, 3.4172, 3.2181, 3.0274, 2.8452, 2.6718, 2.507, 2.3507, 2.2029, 2.0632, 1.9315, 1.8074, 1.6907, 1.581, 1.478, 1.3813, 1.2907, 1.2058, 1.1262, 1.0518, 0.9821],
            75: [8.3725, 8.5301, 8.6748, 8.8069, 8.9269, 9.0354, 9.133, 9.2207, 9.299, 9.3687, 9.4307, 9.4856, 9.5341, 9.5769, 9.6145, 9.6475, 9.6764, 9.7016, 9.7235, 9.7426, 9.759, 9.7731, 9.7852, 9.7954, 9.8039, 9.8109, 9.8164, 9.8207, 9.8238, 9.8256, 9.8264, 9.826, 9.8244, 9.8218, 9.8179, 9.8127, 9.8062, 9.7981, 9.7885, 9.777, 9.7635, 9.7478, 9.7296, 9.7086, 9.6845, 9.6568, 9.6251, 9.589, 9.5479, 9.5012, 9.4484, 9.3887, 9.3214, 9.2458, 9.1612, 9.0668, 8.9619, 8.8457, 8.7176, 8.5771, 8.4238, 8.2574, 8.078, 7.8856, 7.6807, 7.4639, 7.2363, 6.9988, 6.7529, 6.5, 6.242, 5.9803, 5.7169, 5.4534, 5.1915, 4.9327, 4.6784, 4.4297, 4.1879, 3.9536, 3.7276, 3.5104, 3.3023, 3.1037, 2.9144, 2.7347, 2.5642, 2.4029, 2.2506, 2.1069, 1.9716, 1.8442, 1.7245, 1.6122, 1.5067, 1.4078, 1.3152, 1.2284, 1.1472, 1.0712],
            80: [8.7082, 8.893, 9.0637, 9.2206, 9.364, 9.4945, 9.6125, 9.7189, 9.8144, 9.8998, 9.976, 10.0437, 10.1036, 10.1567, 10.2034, 10.2445, 10.2806, 10.3121, 10.3397, 10.3636, 10.3844, 10.4023, 10.4176, 10.4307, 10.4417, 10.4508, 10.4582, 10.4641, 10.4684, 10.4714, 10.4731, 10.4734, 10.4724, 10.4701, 10.4665, 10.4614, 10.4548, 10.4466, 10.4366, 10.4246, 10.4105, 10.3939, 10.3747, 10.3524, 10.3267, 10.2973, 10.2636, 10.2252, 10.1814, 10.1317, 10.0754, 10.0118, 9.9401, 9.8595, 9.7694, 9.6687, 9.5568, 9.4329, 9.2963, 9.1465, 8.983, 8.8056, 8.6142, 8.409, 8.1905, 7.9594, 7.7166, 7.4633, 7.2011, 6.9315, 6.6562, 6.3772, 6.0963, 5.8153, 5.536, 5.26, 4.9888, 4.7237, 4.4658, 4.2159, 3.9749, 3.7433, 3.5215, 3.3096, 3.1078, 2.9161, 2.7343, 2.5624, 2.3999, 2.2467, 2.1023, 1.9665, 1.8389, 1.7191, 1.6066, 1.5012, 1.4024, 1.3099, 1.2232, 1.1422],
            85: [8.9638, 9.1716, 9.3646, 9.543, 9.7069, 9.8566, 9.9927, 10.1159, 10.2268, 10.3264, 10.4155, 10.4949, 10.5654, 10.6279, 10.6831, 10.7318, 10.7745, 10.812, 10.8448, 10.8734, 10.8982, 10.9196, 10.9381, 10.9539, 10.9672, 10.9784, 10.9876, 10.9949, 11.0006, 11.0046, 11.0072, 11.0082, 11.0078, 11.0059, 11.0026, 10.9976, 10.9911, 10.9827, 10.9725, 10.9601, 10.9454, 10.9282, 10.9081, 10.8848, 10.858, 10.8271, 10.7918, 10.7515, 10.7055, 10.6533, 10.5941, 10.5273, 10.4519, 10.3673, 10.2724, 10.1666, 10.0489, 9.9187, 9.7751, 9.6175, 9.4456, 9.2591, 9.0578, 8.8421, 8.6123, 8.3693, 8.114, 7.8477, 7.5719, 7.2884, 6.999, 6.7056, 6.4102, 6.1148, 5.8211, 5.5308, 5.2457, 4.9669, 4.6957, 4.433, 4.1796, 3.936, 3.7027, 3.48, 3.2678, 3.0662, 2.8751, 2.6942, 2.5234, 2.3623, 2.2105, 2.0677, 1.9335, 1.8075, 1.6893, 1.5784, 1.4745, 1.3772, 1.2861, 1.2009],
            90: [9.1519, 9.3778, 9.5888, 9.7845, 9.965, 10.1306, 10.2816, 10.4188, 10.5427, 10.6542, 10.7542, 10.8435, 10.923, 10.9935, 11.056, 11.1111, 11.1597, 11.2023, 11.2396, 11.2722, 11.3005, 11.3251, 11.3462, 11.3644, 11.3798, 11.3927, 11.4034, 11.4121, 11.4189, 11.4239, 11.4272, 11.4289, 11.4291, 11.4276, 11.4245, 11.4197, 11.4132, 11.4048, 11.3944, 11.3817, 11.3667, 11.3489, 11.3282, 11.3041, 11.2764, 11.2444, 11.2078, 11.1659, 11.1183, 11.0641, 11.0027, 10.9333, 10.855, 10.7671, 10.6687, 10.5588, 10.4366, 10.3013, 10.1522, 9.9886, 9.81, 9.6163, 9.4073, 9.1832, 8.9446, 8.6921, 8.427, 8.1504, 7.864, 7.5695, 7.269, 6.9643, 6.6575, 6.3506, 6.0456, 5.7442, 5.448, 5.1584, 4.8767, 4.6039, 4.3407, 4.0878, 3.8455, 3.6141, 3.3938, 3.1844, 2.9859, 2.7981, 2.6207, 2.4533, 2.2957, 2.1474, 2.008, 1.8771, 1.7543, 1.6392, 1.5313, 1.4302, 1.3356, 1.2471],
            95: [9.2936, 9.5341, 9.7594, 9.9692, 10.1633, 10.3418, 10.5052, 10.6538, 10.7885, 10.9099, 11.019, 11.1167, 11.2037, 11.2811, 11.3497, 11.4104, 11.4638, 11.5108, 11.552, 11.5879, 11.6193, 11.6465, 11.67, 11.6902, 11.7073, 11.7218, 11.7339, 11.7437, 11.7515, 11.7573, 11.7613, 11.7636, 11.7642, 11.763, 11.7602, 11.7556, 11.7491, 11.7407, 11.7302, 11.7173, 11.702, 11.6838, 11.6626, 11.638, 11.6094, 11.5766, 11.539, 11.4959, 11.4469, 11.3912, 11.328, 11.2565, 11.176, 11.0855, 10.9842, 10.8711, 10.7453, 10.606, 10.4524, 10.284, 10.1002, 9.9007, 9.6855, 9.4548, 9.2091, 8.9492, 8.6762, 8.3914, 8.0966, 7.7934, 7.4839, 7.1702, 6.8543, 6.5384, 6.2243, 5.914, 5.609, 5.3109, 5.0209, 4.74, 4.4691, 4.2086, 3.9592, 3.721, 3.4941, 3.2785, 3.0742, 2.8808, 2.6981, 2.5258, 2.3636, 2.2109, 2.0674, 1.9326, 1.8062, 1.6876, 1.5765, 1.4725, 1.3751, 1.2839],
            100: [9.4118, 9.665, 9.9029, 10.1251, 10.3312, 10.5213, 10.6957, 10.8547, 10.9991, 11.1295, 11.2469, 11.3521, 11.4461, 11.5297, 11.604, 11.6697, 11.7276, 11.7786, 11.8234, 11.8625, 11.8966, 11.9263, 11.9519, 11.974, 11.9928, 12.0087, 12.022, 12.0329, 12.0416, 12.0482, 12.0529, 12.0557, 12.0567, 12.0559, 12.0533, 12.0489, 12.0425, 12.0341, 12.0234, 12.0105, 11.9949, 11.9764, 11.9547, 11.9295, 11.9004, 11.8668, 11.8283, 11.7842, 11.734, 11.6769, 11.6122, 11.539, 11.4564, 11.3637, 11.2598, 11.1439, 11.0149, 10.8722, 10.7148, 10.5421, 10.3537, 10.1492, 9.9286, 9.6921, 9.4402, 9.1738, 8.8939, 8.602, 8.2997, 7.989, 7.6717, 7.3501, 7.0263, 6.7024, 6.3805, 6.0624, 5.7498, 5.4442, 5.1469, 4.8589, 4.5812, 4.3142, 4.0585, 3.8143, 3.5817, 3.3608, 3.1513, 2.953, 2.7658, 2.5892, 2.4228, 2.2663, 2.1192, 1.981, 1.8514, 1.7299, 1.616, 1.5094, 1.4095, 1.3161]
        };

    function getClosestLevel(level, positions) {
        const availableLevels = Object.keys(positions).map(Number);
        let closestLevel = availableLevels[0];
        for (let i = 1; i < availableLevels.length; i++) {
            if (Math.abs(level - availableLevels[i]) < Math.abs(level - closestLevel)) {
                closestLevel = availableLevels[i];
            }
        }
        return closestLevel;
    }

    // Helper function to convert to dB
    function convertToDb(magnitudeArray) {
        return magnitudeArray.map(value => 20 * Math.log10(value));
    }

    // Convert all position datasets to dB
    [LevelPositions].forEach((positions) => {
        Object.keys(positions).forEach((key) => {
            positions[key] = convertToDb(positions[key]);
        });
    });

function renderGraph(Level) {
    Plotly.newPlot('graph', [
        { x: frequency, y: LevelPositions[Level], type: 'scatter', mode: 'lines', name: `Level @ ${Level}%` }
    ], {
        title: {
            text: `<a href='https://rhpfelectronics.com/rhpf-electronics-handmade-guitar-pedals-in-switzerland/rhpf-nerd-lab/' target='_blank'>RhPf Electronics</a> - Xotic EP Booster - Level: ${Level}%`,
            font: {
                size: 8 // Adjust title font size here
            }
        },
        xaxis: {
            title: {
                text: 'Frequency (Hz)',
                font: { size: 8 } // Adjust x-axis title font size if needed
            },
            type: 'log',
            tickvals: [20, 32, 64, 128, 256, 512, 1000, 2000, 4000, 8000, 16000, 20000],
            ticktext: ["20", "32", "64", "128", "256", "512", "1k", "2k", "4k", "8k", "16k", "20k"]
        },
        yaxis: {
            title: {
                text: 'Gain (dB)',
                font: { size: 8 } // Adjust y-axis title font size if needed
            },
            range: [-10, 25] // Fixed Y-axis range
        },
        legend: {
            font: {
                size: 8 // Adjust legend font size here
            }
        }
    });
}

    function updatePointer(pointerId, angle) {
        const pointer = document.getElementById(pointerId);
        pointer.setAttribute('transform', `rotate(${angle} 0 0)`);
    }

    const knobs = {
        Level: { element: document.getElementById('knob-Level'), pointerId: 'Level-pointer', angle: 0, positions: LevelPositions },
    };

    function updateKnob(knob, delta, pointerId, positions, setAngle) {
        knob.angle += delta;
        knob.angle = Math.max(-135, Math.min(135, knob.angle)); // Clamp angle
        const value = Math.round(((knob.angle + 135) / 270) * 100);
        setAngle(knob.angle);
        updatePointer(pointerId, knob.angle);

        // Update graph with all knob values
        const levels = Object.keys(knobs).reduce((acc, key) => {
            acc[key] = getClosestLevel(
                Math.round(((knobs[key].angle + 135) / 270) * 100),
                knobs[key].positions
            );
            return acc;
        }, {});

        renderGraph(levels.Level);
    }

function addKnobListeners(knobKey) {
    const knob = knobs[knobKey];
    const { element, pointerId, positions } = knob;

    // Handle both mouse and touch start
    const startEvent = (event) => {
        const isTouch = event.type === "touchstart";
        const clientX = isTouch ? event.touches[0].clientX : event.clientX;
        const clientY = isTouch ? event.touches[0].clientY : event.clientY;

        const rect = element.getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;
	document.body.style.overflow = 'hidden';

const moveEvent = (e) => {
    const moveClientX = isTouch ? e.touches[0].clientX : e.clientX;
    const moveClientY = isTouch ? e.touches[0].clientY : e.clientY;
    const dx = moveClientX - cx;
    const dy = moveClientY - cy;

    let angle = Math.atan2(dy, dx) * (180 / Math.PI);
    angle = (angle + 360) % 360;

    if (angle >= 134 || angle <= 46) {
        if (angle <= 46) angle += 360;

        let newKnobAngle = angle - 135; // normalized 0–270°
        newKnobAngle = Math.max(0, Math.min(272, newKnobAngle)); // allow slight overshoot

        // Snap to exact min/max
        if (newKnobAngle < 2) newKnobAngle = 0;
        if (newKnobAngle > 268) newKnobAngle = 270;

        const desiredAngle = newKnobAngle - 135; // -135 to +135
        const delta = desiredAngle - knob.angle;
        updateKnob(knob, delta, pointerId, positions, (a) => (knob.angle = a));
    }
};

        const endEvent = () => {
            document.removeEventListener(isTouch ? "touchmove" : "mousemove", moveEvent);
            document.removeEventListener(isTouch ? "touchend" : "mouseup", endEvent);
        };

        document.addEventListener(isTouch ? "touchmove" : "mousemove", moveEvent);
        document.addEventListener(isTouch ? "touchend" : "mouseup", endEvent);
    };

    // Add event listeners for mouse and touch
    element.addEventListener("mousedown", startEvent);
    element.addEventListener("touchstart", startEvent, { passive: false }); // Passive false to prevent scrolling

    // Scroll wheel functionality
    element.addEventListener("wheel", (event) => {
        event.preventDefault();
        const delta = event.deltaY > 0 ? -5 : 5; // Scroll direction adjusts knob
        const deltaAngle = delta * (270 / 100); // Map delta to angle
        updateKnob(knob, deltaAngle, pointerId, positions, (angle) => (knob.angle = angle));
    });
}

// Add event listeners to all knobs
Object.keys(knobs).forEach(addKnobListeners);

// Initialize pointers
Object.keys(knobs).forEach((key) => {
    updatePointer(knobs[key].pointerId, knobs[key].angle);
});

    // Initialize graph
    renderGraph(50);
</script>
</body>
</html>
